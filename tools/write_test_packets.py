#!/usr/bin/python3

import re

source = """
udp-recv[mdns]: 00 00 84 00 00 00 00 02 00 00 00 03 10 5f 73 70 6f 74 69 66 79 2d 63 6f 6e 6e 65 63 74 04 5f 74
udp-recv[mdns]: 63 70 05 6c 6f 63 61 6c 00 00 0c 00 01 00 00 00 3c 00 24 21 39 33 39 37 66 34 33 66 2d 62 36 35
udp-recv[mdns]: 32 2d 35 33 34 36 2d 39 65 33 64 2d 32 35 36 64 36 38 39 2d 30 c0 0c 09 5f 73 65 72 76 69 63 65
udp-recv[mdns]: 73 07 5f 64 6e 73 2d 73 64 04 5f 75 64 70 c0 22 00 0c 00 01 00 00 00 3c 00 02 c0 0c c0 33 00 21
udp-recv[mdns]: 00 01 00 00 00 3c 00 2a 00 00 00 00 92 2e 21 39 33 39 37 66 34 33 66 2d 62 36 35 32 2d 35 33 34
udp-recv[mdns]: 36 2d 39 65 33 64 2d 32 35 36 64 36 38 39 2d 30 c0 22 c0 33 00 10 00 01 00 00 00 3c 00 21 0b 43
udp-recv[mdns]: 50 61 74 68 3d 2f 7a 63 2f 30 0b 56 45 52 53 49 4f 4e 3d 31 2e 30 08 53 74 61 63 6b 3d 53 50 c0
udp-recv[mdns]: 8e 00 01 00 01 00 00 00 3c 00 04 c0 a8 00 c0  (239 bytes)

udp-recv[mdns]: 00 00 00 00 00 03 00 00 00 00 00 01 0f 5f 63 6f 6d 70 61 6e 69 6f 6e 2d 6c 69 6e 6b 04 5f 74 63
udp-recv[mdns]: 70 05 6c 6f 63 61 6c 00 00 0c 00 01 08 5f 68 6f 6d 65 6b 69 74 c0 1c 00 0c 00 01 0c 5f 73 6c 65
udp-recv[mdns]: 65 70 2d 70 72 6f 78 79 04 5f 75 64 70 c0 21 00 0c 00 01 00 00 29 05 a0 00 00 11 94 00 12 00 04
udp-recv[mdns]: 00 0e 00 03 e2 33 8e 88 2d 65 16 14 86 df a4 9d  (112 bytes)

udp-recv[mdns]: 1a 6b 00 00 00 01 00 00 00 00 00 00 03 31 39 32 03 31 36 38 01 30 03 31 34 39 07 69 6e 2d 61 64
udp-recv[mdns]: 64 72 04 61 72 70 61 00 00 0c 00 01  (44 bytes)

udp-recv[mdns]: 22 14 00 00 00 01 00 00 00 00 00 00 03 31 39 32 03 31 36 38 01 30 03 31 35 32 07 69 6e 2d 61 64
udp-recv[mdns]: 64 72 04 61 72 70 61 00 00 0c 00 01  (44 bytes)

udp-recv[mdns]: 22 15 00 00 00 01 00 00 00 00 00 00 03 31 39 32 03 31 36 38 01 30 03 32 30 39 07 69 6e 2d 61 64
udp-recv[mdns]: 64 72 04 61 72 70 61 00 00 0c 00 01  (44 bytes)

udp-recv[mdns]: 22 3a 00 00 00 01 00 00 00 00 00 00 03 31 39 32 03 31 36 38 01 30 03 31 38 37 07 69 6e 2d 61 64
udp-recv[mdns]: 64 72 04 61 72 70 61 00 00 0c 00 01  (44 bytes)

udp-recv[mdns]: 00 00 00 00 00 03 00 00 00 03 00 00 07 41 6e 64 72 6f 69 64 05 6c 6f 63 61 6c 00 00 ff 80 01 c0
udp-recv[mdns]: 0c 00 ff 80 01 0b 6a 61 63 6f 62 2d 70 68 6f 6e 65 05 5f 68 74 74 70 04 5f 74 63 70 c0 14 00 ff
udp-recv[mdns]: 80 01 c0 0c 00 01 00 01 00 00 00 78 00 04 c0 a8 00 95 c0 0c 00 1c 00 01 00 00 00 78 00 10 fe 80
udp-recv[mdns]: 00 00 00 00 00 00 42 4e 36 ff fe 1e ec c1 c0 25 00 21 00 01 00 00 00 78 00 08 00 00 00 00 00 50
udp-recv[mdns]: c0 0c  (130 bytes)

udp-recv[mdns]: 00 00 84 00 00 00 00 08 00 00 00 04 03 31 34 39 01 30 03 31 36 38 03 31 39 32 07 69 6e 2d 61 64
udp-recv[mdns]: 64 72 04 61 72 70 61 00 00 0c 80 01 00 00 00 78 00 0f 07 41 6e 64 72 6f 69 64 05 6c 6f 63 61 6c
udp-recv[mdns]: 00 01 31 01 43 01 43 01 45 01 45 01 31 01 45 01 46 01 46 01 46 01 36 01 33 01 45 01 34 01 32 01
udp-recv[mdns]: 34 01 30 01 30 01 30 01 30 01 30 01 30 01 30 01 30 01 30 01 30 01 30 01 30 01 30 01 38 01 45 01
udp-recv[mdns]: 46 03 69 70 36 c0 22 00 0c 80 01 00 00 00 78 00 02 c0 32 0b 6a 61 63 6f 62 2d 70 68 6f 6e 65 05
udp-recv[mdns]: 5f 68 74 74 70 04 5f 74 63 70 c0 3a 00 10 80 01 00 00 11 94 00 01 00 09 5f 73 65 72 76 69 63 65
udp-recv[mdns]: 73 07 5f 64 6e 73 2d 73 64 04 5f 75 64 70 c0 3a 00 0c 00 01 00 00 11 94 00 02 c0 9f c0 9f 00 0c
udp-recv[mdns]: 00 01 00 00 11 94 00 02 c0 93 c0 32 00 01 80 01 00 00 00 78 00 04 c0 a8 00 95 c0 32 00 1c 80 01
udp-recv[mdns]: 00 00 00 78 00 10 fe 80 00 00 00 00 00 00 42 4e 36 ff fe 1e ec c1 c0 93 00 21 80 01 00 00 00 78
udp-recv[mdns]: 00 08 00 00 00 00 00 50 c0 32 c0 0c 00 2f 80 01 00 00 00 78 00 06 c0 0c 00 02 00 08 c0 41 00 2f
udp-recv[mdns]: 80 01 00 00 00 78 00 06 c0 41 00 02 00 08 c0 93 00 2f 80 01 00 00 11 94 00 09 c0 93 00 05 00 00
udp-recv[mdns]: 80 00 40 c0 32 00 2f 80 01 00 00 00 78 00 08 c0 32 00 04 40 00 00 08  (375 bytes)

udp-send[mdns]: 00 00 84 00 00 00 00 04 00 00 00 01 20 34 66 62 31 61 31 35 35 35 33 33 36 35 37 33 32 33 32 32
udp-send[mdns]: 30 32 30 32 30 66 66 31 39 33 38 31 31 03 5f 66 6b 04 5f 74 63 70 05 6c 6f 63 61 6c 00 00 21 80
udp-send[mdns]: 01 00 00 00 78 00 2e 00 00 00 00 00 50 20 34 66 62 31 61 31 35 35 35 33 33 36 35 37 33 32 33 32
udp-send[mdns]: 32 30 32 30 32 30 66 66 31 39 33 38 31 31 05 6c 6f 63 61 6c 00 20 34 66 62 31 61 31 35 35 35 33
udp-send[mdns]: 33 36 35 37 33 32 33 32 32 30 32 30 32 30 66 66 31 39 33 38 31 31 03 5f 66 6b 04 5f 74 63 70 05
udp-send[mdns]: 6c 6f 63 61 6c 00 00 10 80 01 00 00 00 78 00 01 00 09 5f 73 65 72 76 69 63 65 73 07 5f 64 6e 73
udp-send[mdns]: 2d 73 64 04 5f 75 64 70 05 6c 6f 63 61 6c 00 00 0c 00 01 00 00 00 78 00 10 03 5f 66 6b 04 5f 74
udp-send[mdns]: 63 70 05 6c 6f 63 61 6c 00 03 5f 66 6b 04 5f 74 63 70 05 6c 6f 63 61 6c 00 00 0c 00 01 00 00 00
udp-send[mdns]: 78 00 31 20 34 66 62 31 61 31 35 35 35 33 33 36 35 37 33 32 33 32 32 30 32 30 32 30 66 66 31 39
udp-send[mdns]: 33 38 31 31 03 5f 66 6b 04 5f 74 63 70 05 6c 6f 63 61 6c 00 20 34 66 62 31 61 31 35 35 35 33 33
udp-send[mdns]: 36 35 37 33 32 33 32 32 30 32 30 32 30 66 66 31 39 33 38 31 31 05 6c 6f 63 61 6c 00 00 01 80 01
udp-send[mdns]: 00 00 00 78 00 04 c0 a8 00 d1  (362 bytes)

udp-recv[mdns]: 00 00 84 00 00 00 00 02 00 00 00 04 09 5f 73 65 72 76 69 63 65 73 07 5f 64 6e 73 2d 73 64 04 5f
udp-recv[mdns]: 75 64 70 05 6c 6f 63 61 6c 00 00 0c 00 01 00 00 00 3c 00 18 10 5f 73 70 6f 74 69 66 79 2d 63 6f
udp-recv[mdns]: 6e 6e 65 63 74 04 5f 74 63 70 c0 23 c0 34 00 0c 00 01 00 00 00 3c 00 24 21 39 33 39 37 66 34 33
udp-recv[mdns]: 66 2d 62 36 35 32 2d 35 33 34 36 2d 39 65 33 64 2d 32 35 36 64 36 38 39 2d 30 c0 34 c0 34 00 0c
udp-recv[mdns]: 00 01 00 00 00 3c 00 02 c0 58 c0 58 00 21 00 01 00 00 00 3c 00 2a 00 00 00 00 92 2e 21 39 33 39
udp-recv[mdns]: 37 66 34 33 66 2d 62 36 35 32 2d 35 33 34 36 2d 39 65 33 64 2d 32 35 36 64 36 38 39 2d 30 c0 23
udp-recv[mdns]: c0 58 00 10 00 01 00 00 00 3c 00 21 0b 43 50 61 74 68 3d 2f 7a 63 2f 30 0b 56 45 52 53 49 4f 4e
udp-recv[mdns]: 3d 31 2e 30 08 53 74 61 63 6b 3d 53 50 c0 9c 00 01 00 01 00 00 00 3c 00 04 c0 a8 00 c0  (253 bytes)

udp-recv[mdns]: 00 00 00 00 00 01 00 00 00 00 00 00 03 5f 66 6b 05 5f 68 74 74 70 04 5f 74 63 70 05 6c 6f 63 61
udp-recv[mdns]: 6c 00 00 0c 00 01  (38 bytes)

udp-recv[mdns]: 00 00 00 00 00 01 00 01 00 00 00 00 03 5f 66 6b 04 5f 74 63 70 05 6c 6f 63 61 6c 00 00 0c 00 01
udp-recv[mdns]: c0 0c 00 0c 00 01 00 00 00 78 00 23 20 34 66 62 31 61 31 35 35 35 33 33 36 35 37 33 32 33 32 32
udp-recv[mdns]: 30 32 30 32 30 66 66 31 39 33 38 31 31 c0 0c  (79 bytes)

udp-send[mdns]: 00 00 84 00 00 00 00 04 00 00 00 01 20 34 66 62 31 61 31 35 35 35 33 33 36 35 37 33 32 33 32 32
udp-send[mdns]: 30 32 30 32 30 66 66 31 39 33 38 31 31 03 5f 66 6b 04 5f 74 63 70 05 6c 6f 63 61 6c 00 00 21 80
udp-send[mdns]: 01 00 00 00 78 00 2e 00 00 00 00 00 50 20 34 66 62 31 61 31 35 35 35 33 33 36 35 37 33 32 33 32
udp-send[mdns]: 32 30 32 30 32 30 66 66 31 39 33 38 31 31 05 6c 6f 63 61 6c 00 20 34 66 62 31 61 31 35 35 35 33
udp-send[mdns]: 33 36 35 37 33 32 33 32 32 30 32 30 32 30 66 66 31 39 33 38 31 31 03 5f 66 6b 04 5f 74 63 70 05
udp-send[mdns]: 6c 6f 63 61 6c 00 00 10 80 01 00 00 00 78 00 01 00 09 5f 73 65 72 76 69 63 65 73 07 5f 64 6e 73
udp-send[mdns]: 2d 73 64 04 5f 75 64 70 05 6c 6f 63 61 6c 00 00 0c 00 01 00 00 00 78 00 10 03 5f 66 6b 04 5f 74
udp-send[mdns]: 63 70 05 6c 6f 63 61 6c 00 03 5f 66 6b 04 5f 74 63 70 05 6c 6f 63 61 6c 00 00 0c 00 01 00 00 00
udp-send[mdns]: 78 00 31 20 34 66 62 31 61 31 35 35 35 33 33 36 35 37 33 32 33 32 32 30 32 30 32 30 66 66 31 39
udp-send[mdns]: 33 38 31 31 03 5f 66 6b 04 5f 74 63 70 05 6c 6f 63 61 6c 00 20 34 66 62 31 61 31 35 35 35 33 33
udp-send[mdns]: 36 35 37 33 32 33 32 32 30 32 30 32 30 66 66 31 39 33 38 31 31 05 6c 6f 63 61 6c 00 00 01 80 01
udp-send[mdns]: 00 00 00 78 00 04 c0 a8 00 d1  (362 bytes)
"""


class Packet:
    def __init__(self):
        self.data = []


inside = False
packets = []
packet = None
for line in source.split("\n"):
    l = re.sub("^.+:\s+", "", line)
    l = re.sub("\s+\(\d+\s+bytes\)", "", l)
    if l:
        if not packet:
            packet = Packet()
            packets.append(packet)
            inside = True
        row = ["0x" + b for b in l.split(" ")]
        packet.data.append(row)
    else:
        packet = None

print(
    """
#pragma once

typedef struct packet_t {
    uint8_t const *data;
    size_t size;
} packet_t;

"""
)

for i, packet in enumerate(packets):
    print("const uint8_t packet_%d[] = {" % (i))
    for row in packet.data:
        print("  " + ", ".join(row) + ",")
    print("};")

print("const packet_t packets[%d] = {" % (len(packets),))
for i, packet in enumerate(packets):
    print("  { packet_%d, sizeof(packet_%d) }," % (i, i))
print("};")
print()
